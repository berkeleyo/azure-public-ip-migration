name: powershell-ci
on:
  push:
  pull_request:
jobs:
  lint:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-pwsh@v4
      - name: Install PSScriptAnalyzer
        shell: pwsh
        run: Install-Module PSScriptAnalyzer -Scope CurrentUser -Force
      - name: Lint PowerShell
        shell: pwsh
        run: |
          if (Test-Path scripts) {
            Invoke-ScriptAnalyzer -Path scripts -Recurse -EnableExit
          } else {
            Write-Host "No scripts directory; skipping"
          }
